<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #36c0a0; -webkit-text-stroke: #36c0a0}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s8 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s9 {font-kerning: none; color: #a7c598; background-color: #171818; -webkit-text-stroke: 0px #a7c598}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s12 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
    span.s13 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s14 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">Local File Batch Processor</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s8">'Inter'</span><span class="s7">,</span><span class="s1"> </span><span class="s5">sans-serif</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Custom scrollbar for log and results */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#log-container::-webkit-scrollbar</span><span class="s7">,</span><span class="s4"> </span><span class="s1">.table-container::-webkit-scrollbar</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s9">8px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s9">8px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#log-container::-webkit-scrollbar-track</span><span class="s7">,</span><span class="s4"> </span><span class="s1">.table-container::-webkit-scrollbar-track</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background:</span><span class="s1"> #f1f5f9</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#log-container::-webkit-scrollbar-thumb</span><span class="s7">,</span><span class="s4"> </span><span class="s1">.table-container::-webkit-scrollbar-thumb</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background:</span><span class="s1"> #94a3b8</span><span class="s7">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s9">10px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#log-container::-webkit-scrollbar-thumb:hover</span><span class="s7">,</span><span class="s4"> </span><span class="s1">.table-container::-webkit-scrollbar-thumb:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background:</span><span class="s1"> #64748b</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.table-container</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">max-height:</span><span class="s1"> </span><span class="s9">400px</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">overflow:</span><span class="s1"> </span><span class="s5">auto</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-100 text-gray-800"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"container mx-auto p-4 md:p-8 max-w-7xl"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white shadow-md rounded-xl p-6 mb-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-3xl font-bold text-gray-900"</span><span class="s3">&gt;</span><span class="s1">Local File Batch Processor</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-gray-600 mt-2"</span><span class="s3">&gt;</span><span class="s1">Upload an Excel file to process orders and display the generated batches directly on this page.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">header</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">main</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white shadow-md rounded-xl p-6"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Step 1: File Upload --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold border-b pb-2 mb-4"</span><span class="s3">&gt;</span><span class="s4">Step 1: Upload Your File</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s1"> </span><span class="s2">for</span><span class="s3">=</span><span class="s5">"file-input"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"block text-sm font-medium text-gray-700"</span><span class="s3">&gt;</span><span class="s1">Select Excel File (.xls, .xlsx)</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"file"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"file-input"</span><span class="s4"> </span><span class="s2">accept</span><span class="s3">=</span><span class="s1">".xls,.xlsx"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"</span><span class="s3">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"start_processing"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-6 w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg shadow transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>Process File</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Step 2: Logging Output --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"log-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden mt-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold border-b pb-2 mb-4"</span><span class="s3">&gt;</span><span class="s4">Processing Log</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"log-container"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-50 p-4 rounded-lg border border-gray-200 h-64 overflow-y-auto text-sm font-mono"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-gray-500"</span><span class="s3">&gt;</span><span class="s1">Logs will appear here...</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">             </span></span><span class="s1">&lt;!-- Step 3: Results Display --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"results-section"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden mt-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold border-b pb-2 mb-4"</span><span class="s3">&gt;</span><span class="s4">Results</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"overall-summary-container"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"detailed-batches-container"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mt-6"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">main</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">footer</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mt-8 text-sm text-gray-500"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s3">&gt;</span><span class="s1">Powered by modern web technologies.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">footer</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> startProcessingButton </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'start_processing'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> fileInput </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'file-input'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> logSection </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'log-section'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> logContainer </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'log-container'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> resultsSection </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'results-section'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> overallSummaryContainer </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'overall-summary-container'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> detailedBatchesContainer </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'detailed-batches-container'</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- CORE PROCESSING LOGIC ---</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>startProcessingButton</span><span class="s7">.</span><span class="s1">onclick </span><span class="s7">=</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> file </span><span class="s7">=</span><span class="s1"> fileInput</span><span class="s7">.</span><span class="s1">files</span><span class="s7">[</span><span class="s12">0</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">file</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>alert</span><span class="s7">(</span><span class="s1">"Please select a file first."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startProcessingButton</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s11">true</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startProcessingButton</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Processing...'</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Show and clear previous results</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>logSection</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>resultsSection</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>logContainer</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>overallSummaryContainer</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>detailedBatchesContainer</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">''</span><span class="s7">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> reader </span><span class="s7">=</span><span class="s1"> </span><span class="s11">new</span><span class="s1"> </span><span class="s13">FileReader</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>reader</span><span class="s7">.</span><span class="s1">onload </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">event</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> data </span><span class="s7">=</span><span class="s1"> </span><span class="s11">new</span><span class="s1"> </span><span class="s13">Uint8Array</span><span class="s7">(</span><span class="s1">event</span><span class="s7">.</span><span class="s1">target</span><span class="s7">.</span><span class="s1">result</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s1">'--- 1. Data Reading and UPC Extraction ---'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> df </span><span class="s7">=</span><span class="s1"> readAndParseExcel</span><span class="s7">(</span><span class="s1">data</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s1">'\n--- 2. Order Aggregation and Filtering ---'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> filteredGroups </span><span class="s7">=</span><span class="s1"> aggregateAndFilter</span><span class="s7">(</span><span class="s1">df</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s1">'\n--- 3. Batching Logic ---'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> batches </span><span class="s7">=</span><span class="s1"> createBatches</span><span class="s7">(</span><span class="s1">filteredGroups</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">batches</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s12">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span>log</span><span class="s7">(</span><span class="s1">"No batches were created based on the criteria."</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'warning'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>resetStartButton</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s11">return</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s8">`Total batches created: </span><span class="s7">${</span><span class="s1">batches</span><span class="s7">.</span><span class="s1">length</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s1">'\n--- 4. Displaying Results ---'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>displayResults</span><span class="s7">(</span><span class="s1">batches</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>resultsSection</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s1">'\n🎉 Processing complete.'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'success'</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s1">`❌ An unexpected error occurred: </span><span class="s7">${</span><span class="s4">error</span><span class="s7">.</span><span class="s4">message</span><span class="s7">}</span><span class="s1">`</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'error'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>console</span><span class="s7">.</span><span class="s1">error</span><span class="s7">(</span><span class="s1">error</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">finally</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>resetStartButton</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>reader</span><span class="s7">.</span><span class="s1">onerror </span><span class="s7">=</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>log</span><span class="s7">(</span><span class="s1">`❌ File could not be read: </span><span class="s7">${</span><span class="s4">error</span><span class="s7">}</span><span class="s1">`</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'error'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>resetStartButton</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>reader</span><span class="s7">.</span><span class="s1">readAsArrayBuffer</span><span class="s7">(</span><span class="s1">file</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- HELPER FUNCTIONS ---</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> log</span><span class="s7">(</span><span class="s1">message</span><span class="s7">,</span><span class="s1"> type </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'info'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> p </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'p'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> colorClass </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'text-gray-800'</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">type </span><span class="s7">===</span><span class="s4"> </span><span class="s1">'error'</span><span class="s7">)</span><span class="s4"> colorClass </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'text-red-600 font-semibold'</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">type </span><span class="s7">===</span><span class="s4"> </span><span class="s1">'success'</span><span class="s7">)</span><span class="s4"> colorClass </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'text-green-600 font-semibold'</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s4"> </span><span class="s7">(</span><span class="s4">type </span><span class="s7">===</span><span class="s4"> </span><span class="s1">'warning'</span><span class="s7">)</span><span class="s4"> colorClass </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'text-yellow-600 font-semibold'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>p</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span><span class="s7">${</span><span class="s1">colorClass</span><span class="s7">}</span><span class="s8"> whitespace-pre-wrap`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>p</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> message</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>logContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">p</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>logContainer</span><span class="s7">.</span><span class="s1">scrollTop </span><span class="s7">=</span><span class="s1"> logContainer</span><span class="s7">.</span><span class="s1">scrollHeight</span><span class="s7">;</span><span class="s1"> </span><span class="s14">// Auto-scroll</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> resetStartButton</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startProcessingButton</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s11">false</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>startProcessingButton</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Process File'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">       </span></span><span class="s11">function</span><span class="s1"> readAndParseExcel</span><span class="s7">(</span><span class="s1">data</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>log</span><span class="s7">(</span><span class="s1">'Parsing Excel file...'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> workbook </span><span class="s7">=</span><span class="s1"> </span><span class="s13">XLSX</span><span class="s7">.</span><span class="s1">read</span><span class="s7">(</span><span class="s1">data</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> type</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'array'</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> sheetName </span><span class="s7">=</span><span class="s1"> workbook</span><span class="s7">.</span><span class="s13">SheetNames</span><span class="s7">[</span><span class="s12">0</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> worksheet </span><span class="s7">=</span><span class="s1"> workbook</span><span class="s7">.</span><span class="s13">Sheets</span><span class="s7">[</span><span class="s1">sheetName</span><span class="s7">];</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> json_data </span><span class="s7">=</span><span class="s1"> </span><span class="s13">XLSX</span><span class="s7">.</span><span class="s1">utils</span><span class="s7">.</span><span class="s1">sheet_to_json</span><span class="s7">(</span><span class="s1">worksheet</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> header</span><span class="s7">:</span><span class="s1"> </span><span class="s12">1</span><span class="s7">,</span><span class="s1"> defval</span><span class="s7">:</span><span class="s1"> </span><span class="s8">""</span><span class="s1"> </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">json_data</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s12">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s11">throw</span><span class="s4"> </span><span class="s11">new</span><span class="s4"> </span><span class="s13">Error</span><span class="s7">(</span><span class="s1">"The Excel file is empty."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> headers </span><span class="s7">=</span><span class="s1"> json_data</span><span class="s7">[</span><span class="s12">0</span><span class="s7">].</span><span class="s1">map</span><span class="s7">(</span><span class="s1">h </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s13">String</span><span class="s7">(</span><span class="s1">h</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> upcIndex </span><span class="s7">=</span><span class="s1"> headers</span><span class="s7">.</span><span class="s1">findIndex</span><span class="s7">(</span><span class="s1">h </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s13">String</span><span class="s7">(</span><span class="s1">h</span><span class="s7">).</span><span class="s1">toUpperCase</span><span class="s7">()</span><span class="s1"> </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'UPC'</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">upcIndex </span><span class="s7">===</span><span class="s1"> </span><span class="s7">-</span><span class="s12">1</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s11">throw</span><span class="s4"> </span><span class="s11">new</span><span class="s4"> </span><span class="s13">Error</span><span class="s7">(</span><span class="s1">"Input file must contain a column with the header 'UPC'."</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>log</span><span class="s7">(</span><span class="s1">`Found 'UPC' header at column index </span><span class="s7">${</span><span class="s4">upcIndex</span><span class="s7">}</span><span class="s1">.`</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> rows </span><span class="s7">=</span><span class="s1"> json_data</span><span class="s7">.</span><span class="s1">slice</span><span class="s7">(</span><span class="s12">1</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> df </span><span class="s7">=</span><span class="s1"> rows</span><span class="s7">.</span><span class="s1">map</span><span class="s7">(</span><span class="s1">row </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">Order_Number</span><span class="s7">:</span><span class="s1"> row</span><span class="s7">[</span><span class="s12">0</span><span class="s7">],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">UPC_Info</span><span class="s7">:</span><span class="s1"> row</span><span class="s7">[</span><span class="s1">upcIndex</span><span class="s7">]</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">})).</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">r </span><span class="s7">=&gt;</span><span class="s1"> r</span><span class="s7">.</span><span class="s13">Order_Number</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> r</span><span class="s7">.</span><span class="s13">UPC_Info</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>df</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">row </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>row</span><span class="s7">.</span><span class="s13">UPC</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s13">String</span><span class="s7">(</span><span class="s1">row</span><span class="s7">.</span><span class="s13">UPC_Info</span><span class="s7">).</span><span class="s1">split</span><span class="s7">(</span><span class="s8">'*'</span><span class="s7">)[</span><span class="s12">0</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>log</span><span class="s7">(</span><span class="s1">`✅ Successfully read and parsed </span><span class="s7">${</span><span class="s4">df</span><span class="s7">.</span><span class="s4">length</span><span class="s7">}</span><span class="s1"> rows.`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">return</span><span class="s1"> df</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> aggregateAndFilter</span><span class="s7">(</span><span class="s1">df</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> groups </span><span class="s7">=</span><span class="s1"> </span><span class="s11">new</span><span class="s1"> </span><span class="s13">Map</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>df</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">row </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> lowerCaseUpc </span><span class="s7">=</span><span class="s1"> </span><span class="s13">String</span><span class="s7">(</span><span class="s1">row</span><span class="s7">.</span><span class="s13">UPC</span><span class="s7">).</span><span class="s1">toLowerCase</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">groups</span><span class="s7">.</span><span class="s1">has</span><span class="s7">(</span><span class="s1">lowerCaseUpc</span><span class="s7">))</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>groups</span><span class="s7">.</span><span class="s11">set</span><span class="s7">(</span><span class="s1">lowerCaseUpc</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>originalUPC</span><span class="s7">:</span><span class="s1"> row</span><span class="s7">.</span><span class="s13">UPC</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>orders</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[]</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>groups</span><span class="s7">.</span><span class="s11">get</span><span class="s7">(</span><span class="s1">lowerCaseUpc</span><span class="s7">).</span><span class="s1">orders</span><span class="s7">.</span><span class="s1">push</span><span class="s7">([</span><span class="s1">row</span><span class="s7">.</span><span class="s13">Order_Number</span><span class="s7">,</span><span class="s1"> row</span><span class="s7">.</span><span class="s13">UPC_Info</span><span class="s7">]);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> upcGroups </span><span class="s7">=</span><span class="s1"> </span><span class="s13">Array</span><span class="s7">.</span><span class="s11">from</span><span class="s7">(</span><span class="s1">groups</span><span class="s7">.</span><span class="s1">entries</span><span class="s7">()).</span><span class="s1">map</span><span class="s7">(([</span><span class="s1">_</span><span class="s7">,</span><span class="s1"> val</span><span class="s7">])</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">({</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">UPC</span><span class="s7">:</span><span class="s1"> val</span><span class="s7">.</span><span class="s1">originalUPC</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">Orders</span><span class="s7">:</span><span class="s1"> val</span><span class="s7">.</span><span class="s1">orders</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">Count</span><span class="s7">:</span><span class="s1"> val</span><span class="s7">.</span><span class="s1">orders</span><span class="s7">.</span><span class="s1">length</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}));</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> filtered </span><span class="s7">=</span><span class="s1"> upcGroups</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">g </span><span class="s7">=&gt;</span><span class="s1"> g</span><span class="s7">.</span><span class="s13">Count</span><span class="s1"> </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s12">3</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>log</span><span class="s7">(</span><span class="s1">`📊 Found </span><span class="s7">${</span><span class="s4">filtered</span><span class="s7">.</span><span class="s4">length</span><span class="s7">}</span><span class="s1"> UPCs (case-insensitive) with 3 or more orders.`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">return</span><span class="s1"> filtered</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> createBatches</span><span class="s7">(</span><span class="s1">filteredGroups</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s4"> </span><span class="s1">BATCH_SIZE_LIMIT</span><span class="s4"> </span><span class="s7">=</span><span class="s4"> </span><span class="s12">500</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> batches </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[];</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> large_upcs </span><span class="s7">=</span><span class="s1"> filteredGroups</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">g </span><span class="s7">=&gt;</span><span class="s1"> g</span><span class="s7">.</span><span class="s13">Count</span><span class="s1"> </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s13">BATCH_SIZE_LIMIT</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>large_upcs</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">group </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batches</span><span class="s7">.</span><span class="s1">push</span><span class="s7">({</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>summary</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[[</span><span class="s1">group</span><span class="s7">.</span><span class="s13">UPC</span><span class="s7">,</span><span class="s1"> group</span><span class="s7">.</span><span class="s13">Count</span><span class="s7">]],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>orders</span><span class="s7">:</span><span class="s1"> group</span><span class="s7">.</span><span class="s13">Orders</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">});</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>log</span><span class="s7">(</span><span class="s1">`📦 Created a dedicated batch for UPC </span><span class="s7">${</span><span class="s4">group</span><span class="s7">.</span><span class="s13">UPC</span><span class="s7">}</span><span class="s1"> with </span><span class="s7">${</span><span class="s4">group</span><span class="s7">.</span><span class="s13">Count</span><span class="s7">}</span><span class="s1"> orders.`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> small_upcs </span><span class="s7">=</span><span class="s1"> filteredGroups</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">g </span><span class="s7">=&gt;</span><span class="s1"> g</span><span class="s7">.</span><span class="s13">Count</span><span class="s1"> </span><span class="s7">&lt;=</span><span class="s1"> </span><span class="s13">BATCH_SIZE_LIMIT</span><span class="s7">)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">.</span><span class="s1">sort</span><span class="s7">((</span><span class="s1">a</span><span class="s7">,</span><span class="s1"> b</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> b</span><span class="s7">.</span><span class="s13">Count</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> a</span><span class="s7">.</span><span class="s13">Count</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">small_upcs</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s12">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">let</span><span class="s1"> current_batch_orders </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[],</span><span class="s1"> current_batch_summary </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[],</span><span class="s1"> current_batch_size </span><span class="s7">=</span><span class="s1"> </span><span class="s12">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>small_upcs</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">group </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">current_batch_size </span><span class="s7">+</span><span class="s1"> group</span><span class="s7">.</span><span class="s13">Count</span><span class="s1"> </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s13">BATCH_SIZE_LIMIT</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> current_batch_size </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s12">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>batches</span><span class="s7">.</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> summary</span><span class="s7">:</span><span class="s1"> current_batch_summary</span><span class="s7">,</span><span class="s1"> orders</span><span class="s7">:</span><span class="s1"> current_batch_orders </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>log</span><span class="s7">(</span><span class="s8">`👍 Finalized a batch with </span><span class="s7">${</span><span class="s1">current_batch_orders</span><span class="s7">.</span><span class="s1">length</span><span class="s7">}</span><span class="s8"> orders.`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>current_batch_orders </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[],</span><span class="s1"> current_batch_summary </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[],</span><span class="s1"> current_batch_size </span><span class="s7">=</span><span class="s1"> </span><span class="s12">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>current_batch_orders</span><span class="s7">.</span><span class="s1">push</span><span class="s7">(...</span><span class="s1">group</span><span class="s7">.</span><span class="s13">Orders</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>current_batch_summary</span><span class="s7">.</span><span class="s1">push</span><span class="s7">([</span><span class="s1">group</span><span class="s7">.</span><span class="s13">UPC</span><span class="s7">,</span><span class="s1"> group</span><span class="s7">.</span><span class="s13">Count</span><span class="s7">]);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>current_batch_size </span><span class="s7">+=</span><span class="s1"> group</span><span class="s7">.</span><span class="s13">Count</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">current_batch_orders</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s12">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>batches</span><span class="s7">.</span><span class="s1">push</span><span class="s7">({</span><span class="s1"> summary</span><span class="s7">:</span><span class="s1"> current_batch_summary</span><span class="s7">,</span><span class="s1"> orders</span><span class="s7">:</span><span class="s1"> current_batch_orders </span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>log</span><span class="s7">(</span><span class="s8">`👍 Finalized the last batch with </span><span class="s7">${</span><span class="s1">current_batch_orders</span><span class="s7">.</span><span class="s1">length</span><span class="s7">}</span><span class="s8"> orders.`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">return</span><span class="s1"> batches</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> displayResults</span><span class="s7">(</span><span class="s1">batches</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 1. Create Overall Summary</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s4"> overallSummaryData </span><span class="s7">=</span><span class="s4"> </span><span class="s7">[[</span><span class="s1">'Batch Name'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Total Orders'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Unique UPCs'</span><span class="s7">]];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>batches</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">((</span><span class="s1">batch</span><span class="s7">,</span><span class="s1"> i</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> total_orders </span><span class="s7">=</span><span class="s1"> batch</span><span class="s7">.</span><span class="s1">orders</span><span class="s7">.</span><span class="s1">length</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> unique_upcs </span><span class="s7">=</span><span class="s1"> batch</span><span class="s7">.</span><span class="s1">summary</span><span class="s7">.</span><span class="s1">length</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> batch_name </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`Batch_</span><span class="s7">${</span><span class="s1">i </span><span class="s7">+</span><span class="s1"> </span><span class="s12">1</span><span class="s7">}</span><span class="s8">_</span><span class="s7">${</span><span class="s1">total_orders </span><span class="s7">+</span><span class="s1"> unique_upcs </span><span class="s7">+</span><span class="s1"> </span><span class="s12">1</span><span class="s7">}</span><span class="s8">`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>overallSummaryData</span><span class="s7">.</span><span class="s1">push</span><span class="s7">([</span><span class="s1">batch_name</span><span class="s7">,</span><span class="s1"> total_orders</span><span class="s7">,</span><span class="s1"> unique_upcs</span><span class="s7">]);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> totalOrdersSum </span><span class="s7">=</span><span class="s1"> overallSummaryData</span><span class="s7">.</span><span class="s1">slice</span><span class="s7">(</span><span class="s12">1</span><span class="s7">).</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">sum</span><span class="s7">,</span><span class="s1"> row</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> sum </span><span class="s7">+</span><span class="s1"> row</span><span class="s7">[</span><span class="s12">1</span><span class="s7">],</span><span class="s1"> </span><span class="s12">0</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>overallSummaryData</span><span class="s7">.</span><span class="s4">push</span><span class="s7">([</span><span class="s1">'&lt;strong&gt;Grand Total&lt;/strong&gt;'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">`&lt;strong&gt;</span><span class="s7">${</span><span class="s4">totalOrdersSum</span><span class="s7">}</span><span class="s1">&lt;/strong&gt;`</span><span class="s7">,</span><span class="s4"> </span><span class="s1">''</span><span class="s7">]);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> overallSummaryTable </span><span class="s7">=</span><span class="s1"> createTable</span><span class="s7">(</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'Overall Summary'</span><span class="s7">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">[</span><span class="s1">'Batch Name'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Total Orders'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Unique UPCs'</span><span class="s7">],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>overallSummaryData</span><span class="s7">.</span><span class="s1">slice</span><span class="s7">(</span><span class="s12">1</span><span class="s7">)</span><span class="s1"> </span><span class="s14">// remove header row for data</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>overallSummaryContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">overallSummaryTable</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 2. Create Detailed Batch Views</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> batchDetailsTitle </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'h3'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>batchDetailsTitle</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'text-xl font-semibold mt-8 mb-4'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>batchDetailsTitle</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Detailed Batch View'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>detailedBatchesContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">batchDetailsTitle</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>batches</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">((</span><span class="s1">batch</span><span class="s7">,</span><span class="s1"> i</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> batch_name </span><span class="s7">=</span><span class="s1"> overallSummaryData</span><span class="s7">[</span><span class="s1">i </span><span class="s7">+</span><span class="s1"> </span><span class="s12">1</span><span class="s7">][</span><span class="s12">0</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> batchContainer </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'div'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batchContainer</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'mb-8 p-4 border rounded-lg bg-gray-50'</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> batchTitle </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'h4'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batchTitle</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'text-lg font-semibold mb-4'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batchTitle</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> batch_name</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batchContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">batchTitle</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> gridContainer </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'div'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>gridContainer</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'grid grid-cols-1 md:grid-cols-2 gap-6'</span><span class="s7">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Batch Summary Table</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> total_orders </span><span class="s7">=</span><span class="s1"> batch</span><span class="s7">.</span><span class="s1">orders</span><span class="s7">.</span><span class="s1">length</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> summaryData </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[...</span><span class="s1">batch</span><span class="s7">.</span><span class="s1">summary</span><span class="s7">,</span><span class="s1"> </span><span class="s7">[</span><span class="s8">`&lt;strong&gt;Total&lt;/strong&gt;`</span><span class="s7">,</span><span class="s1"> </span><span class="s8">`&lt;strong&gt;</span><span class="s7">${</span><span class="s1">total_orders</span><span class="s7">}</span><span class="s8">&lt;/strong&gt;`</span><span class="s7">]];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> summaryTable </span><span class="s7">=</span><span class="s1"> createTable</span><span class="s7">(</span><span class="s8">'UPCs in Batch'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">[</span><span class="s8">'UPC'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'Order Count'</span><span class="s7">],</span><span class="s1"> summaryData</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s14">// Orders Table</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> ordersTable </span><span class="s7">=</span><span class="s1"> createTable</span><span class="s7">(</span><span class="s8">'Orders in Batch'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">[</span><span class="s8">'Order Number'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'UPC Info (Raw)'</span><span class="s7">],</span><span class="s1"> batch</span><span class="s7">.</span><span class="s1">orders</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>gridContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">summaryTable</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>gridContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">ordersTable</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>batchContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">gridContainer</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>detailedBatchesContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">batchContainer</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>log</span><span class="s7">(</span><span class="s1">'✅ Successfully rendered results on the page.'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> createTable</span><span class="s7">(</span><span class="s1">title</span><span class="s7">,</span><span class="s1"> headers</span><span class="s7">,</span><span class="s1"> data</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> container </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'div'</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> tableTitle </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'h5'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>tableTitle</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'font-semibold mb-2'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>tableTitle</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> title</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>container</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">tableTitle</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> tableContainer </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'div'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>tableContainer</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'table-container border rounded-md'</span><span class="s7">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> table </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'table'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>table</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'min-w-full divide-y divide-gray-200'</span><span class="s7">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> thead </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'thead'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>thead</span><span class="s7">.</span><span class="s1">className </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'bg-gray-100'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> headerRow </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'tr'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>headers</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">headerText </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> th </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'th'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>th</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>th</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> headerText</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>headerRow</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">th</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>thead</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">headerRow</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>table</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">thead</span><span class="s7">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> tbody </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'tbody'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>tbody</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'bg-white divide-y divide-gray-200'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>data</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">rowData </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> tr </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'tr'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>rowData</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">cellData </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> td </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">createElement</span><span class="s7">(</span><span class="s8">'td'</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span>td</span><span class="s7">.</span><span class="s4">className </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'px-4 py-2 whitespace-nowrap text-sm text-gray-700'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>td</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> cellData</span><span class="s7">;</span><span class="s1"> </span><span class="s14">// Use innerHTML to render bold tags</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>tr</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">td</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>tbody</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">tr</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>table</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">tbody</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>tableContainer</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">table</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>container</span><span class="s7">.</span><span class="s1">appendChild</span><span class="s7">(</span><span class="s1">tableContainer</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">return</span><span class="s1"> container</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
</body>
</html>
